# v1.7.0 Roadmap: Advanced AST Chunking

## Goal
Replace regex-based chunking with AST-aware chunking to improve search context and retrieval quality.

## Selected Library: `code-chunk`
- **Source**: [supermemoryai/code-chunk](https://github.com/supermemoryai/code-chunk)
- **Why**: 
  - Uses `web-tree-sitter` (WASM) -> Compatible with Bun/Edge.
  - Generates `contextualizedText` (e.g. `# Scope: UserService`) -> Better embeddings.
  - Supports TS/JS/Py/Go/Java.
  - Lightweight compared to full tree-sitter bindings.

## Implementation Plan
1. **Dependency**: Install `code-chunk` and `web-tree-sitter`.
2. **Refactor**: Replace `src/indexer/chunker.ts` logic with `code-chunk`.
3. **Schema**: Update `EmbeddingRecord` to store `context` metadata (scope chain).
4. **Migration**: Requires full re-index (breaking change for index).

## Benefits
- **No split functions**: Chunks respect function boundaries.
- **Context injection**: Embeddings include class/module context even if chunk is deep inside a method.
- **Better recall**: "function in User class" query matches better against context-enriched chunks.
