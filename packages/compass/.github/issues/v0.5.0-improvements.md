# v0.5.0: Quality & Usability Improvements

## Overview
Focus on reducing noise, preventing bloat, and improving visibility. **No new embedding complexity.**

Based on 5-approaches analysis and ELF reference study.

---

## Scope (Refined after 5-Approaches Analysis)

| Feature | Ship? | Effort | Impact | Rationale |
|---------|-------|--------|--------|-----------|
| ✅ Exact-match deduplication | YES | 30 min | 6/10 | Zero false positives |
| ✅ Smarter passive filtering | YES | 1h | 8/10 | High value, reduces noise |
| ✅ `semanthicc status` command | YES | 1h | 7/10 | Essential visibility |
| ❌ Fuzzy Jaccard deduplication | NO | - | - | False positive risk |
| ❌ `semanthicc prune` command | NO | - | - | Confidence decay handles it |

**Total effort: ~2.5 hours for 3 high-quality features**

---

## Feature 1: Exact-Match Deduplication

**Problem**: User can add "Never use any" 10 times.

**Solution**: On `addMemory()`, reject if exact content already exists for same project/global scope.

**Why NOT fuzzy/Jaccard**:
- False positives frustrate users ("Use React Query" blocked by "Use React Router")
- Exact match has zero false positives
- If user wants similar content, they can supersede

**Files**: `src/heuristics/repository.ts`

**Test cases**:
- Exact duplicate → rejected ✅
- Same content, different project → allowed ✅
- Similar but not exact → allowed ✅

---

## Feature 2: Smarter Passive Filtering

**Problem**: Every tool error becomes a "learning", including transient junk.

**Current**: Capture if `keywords.length >= 3`

**Improved**:
```typescript
const TRANSIENT_PATTERNS = [
  /ECONNRESET/i,
  /ETIMEDOUT/i,
  /ECONNREFUSED/i,
  /socket hang up/i,
  /network timeout/i,
];

const FALSE_POSITIVE_PATTERNS = [
  /error handling/i,      // Talking about errors, not an error
  /fixed the error/i,     // Success message
  /no errors?( found)?/i, // Success message
];

const PASSIVE_CONFIG = {
  MIN_KEYWORDS: 4,           // Up from 3
  MIN_CONTENT_LENGTH: 30,    // Skip very short errors
};
```

**Inspiration**: ELF uses similar regex patterns for false-positive detection.

**Files**: `src/hooks/passive-learner.ts`

**Test cases**:
- `ECONNRESET` → ignored ✅
- `ETIMEDOUT` → ignored ✅
- "error handling code" → ignored ✅
- "TypeError: x is undefined" → captured ✅

---

## Feature 3: `semanthicc status` Command

**Problem**: No visibility into system state.

**Output**:
```
Project: my-project (/path/to/project)
Index: 1,247 chunks | Last indexed: 2h ago ✅
Memories: 12 total
  ⭐ 2 golden | 8 regular | 2 passive
  Types: 5 patterns, 3 rules, 2 decisions, 2 learnings
  Confidence: avg 0.68 | min 0.42 | max 0.95
```

**Files**: `src/index.ts` (add action), new `src/status.ts`

---

## Non-Goals (Analyzed and Rejected)

| Feature | Why Rejected | Analysis |
|---------|--------------|----------|
| Fuzzy Jaccard deduplication | False positive risk > benefit | 5-approaches: Inversion showed "Use React X" conflicts |
| `prune` command | Confidence decay already handles cleanup | 5-approaches: Prior art (ELF) archives automatically |
| Semantic heuristic retrieval | Overkill for <100 memories | 5-approaches: SQL is fine, embeddings add complexity |
| BM25 hybrid search | Vector-only works well enough | 5-approaches: YAGNI, no user complaints |

---

## Acceptance Criteria

- [ ] Exact duplicate memories rejected with clear error message
- [ ] Transient network errors not captured as learnings
- [ ] False positive patterns ("error handling") not captured
- [ ] `status` command shows accurate counts and freshness
- [ ] All existing 168 tests still pass
- [ ] New tests for each feature (~10 new tests)

---

## References

- ELF noise filtering patterns: `references/elf/src/elf/learning_engine.py`
- ELF metrics implementation: `references/elf/src/elf/mcp/tools/metrics.py`
- 5-approaches analysis: Session discussion 2026-01-04
